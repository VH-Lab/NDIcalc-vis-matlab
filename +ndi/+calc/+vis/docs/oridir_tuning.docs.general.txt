This calculator object computes several index values and fits of orientation and/or direction tuning given a set of stimulus responses at a range of stimulus angles as described in Mazurek et al. (2014)

There are two major types of indexes returned. One set are "fitless" index values that use vector methods to identify the preferred orientation and direction and the degree of tuning (such as circular variance and circular variance in direction space).

The data are also fit to a double Gaussian function of the form:

R(theta) = C + Rp * exp(-(ang_dir(theta - theta_pref)^2) / (2*sigma^2)) + ...
    Rn * exp(-(ang_dir(theta + 180 - theta_pref)^2) / (2*sigma^2))

where the fit parameters are 
         Rsp       - the untuned responseof the neuron
         Rp        - the above-offset response to the preferred orientation
         thetaPref - the stimulus angle that evokes the maximum response
         sigma     - the tuning width parameter
         Rn        - the above-offset response to the null direction
         C         - the offset constant
	 exp(x)    - the exponential function exp(x) = e^x
         ang_dir(x)- the angular difference function ang_dir(x) = min(x, x-360, x+360)
   
The orientation direction tuning document has the following fields:

properties:
		coordinates:                   	The orientation/direction coordinate basis, can be "compass" or "cartesian"
		response_units:		       	The units of the response
	      	response_type:		       	The category of the response (e.g. "mean")
tuning_curve:
         	direction:                     	The set of direction angles tested, in degrees (1xN vector)
         	mean:				The mean response to each direction (note that these responses may be normalized or control-subtracted)
	      	stddev:				The standard deviation of the response to each direction
	      	stderr:				The standard error of the mean of the response to each direction
         	individual:			The individual response values for each direction (note that these responses may be normalized or control-subtracted)
	      	raw_individual:			The unprocessed generated response values for each direction (without blank subtraction or normalization)
	      	control_individual:		The response values to the control stimuli (such as a blank screen with the same duration as the stimuli)
significance:
         	visual_response_anova_p:	The p-value relating the different mean response values between the raw and control groups
	      	across_stimuli_anova_p:		The p-value relating the different mean response values generated by different stimuli
vector:
         	circular_variance:              A value related to selectivity and tuning width, a classic quantity in circular statistics
         	direction_circular_variance:    A value related to selectivity and tuning width, differs from classic definition due to its presence in the direction space
        	hotelling2test:                 The value of the Hotelling's T-squared Test of whether the orientaion vectors and [0,0] are different
         	orientation_preference:         The orientation with the highest response in orientation vector space
         	direction_preference:           The direction with the highest response in direction vector space
         	direction_hotelling2test:       The value of the Hotelling's T-squared Test of the direction vector (quite insensitive)
         	dot_direction_significance:     The value of the "direction dot product test" that uses both orientation vectors and direction vectors to assess the direction selectivity of a cell (Mazurek et al. 2014)
fit:
    double_gaussian_parameters:                 The parameters used for the double gaussian function: [Rsp Rp theta_Pref sigma Rn]
    double_gaussian_fit_angles:	                A set of angles that forms the X-axis (angle axis) for the fit function (usually 0:359)
    double_gaussian_fit_values:	                The value of the response fit at each angle in double_gaussian_fit_angles		
    orientation_angle_preference:	        The stimulus angle of orientation that evokes the maximum response in the fit
    direction_angle_preference:	                The stimulue angle of direction that evokes the maximum response in the fit
    hwhh:				        Half width at half height, the angle difference that produces half of the response compared to the most optimal
    orientation_preferred_orthogonal_ratio:     The ratio of the response to the preferred orientation to the response at the orthogonal orientation (90 degrees away)
    direction_preferred_null_ratio:             The ratio of the response to the preferred direction to that of the null direction
    orientation_preferred_orthogonal_ratio_rectified:	 The preferred/orthogonal ratio except that each response is rectified so it cannot be below 0 (even after blank subtraction) 
    direction_preferred_null_ratio_rectified:	The preferred/orthogonal ratio except that each response is rectified so it cannot be below 0 (even after blank subtraction, for example)
         
         
         
         
         
         
   
   
